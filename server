#!/usr/bin/env python

from httpdhs.http import HttpServer
from httpdhs.partitioning import ConsistentHashingPartitioningStrategy
from httpdhs.backend import KeyValueController
from optparse import OptionParser

parser = OptionParser()
parser.add_option("-p", "--port", dest="port", help="run on port PORT", metavar="PORT")
(options, args) = parser.parse_args()

strategy = ConsistentHashingPartitioningStrategy(
    ["localhost:1234", "localhost:4321"], replicas=3)
node_name = "localhost:%s" % (options.port)
backend = KeyValueController(node_name, strategy)
HttpServer(backend).run(options.port)

print "Done."
